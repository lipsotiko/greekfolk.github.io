import{a as k,C as b,b as p,s as I,k as C,A as h,B as f,D as $,w as m,o as a,e as n,h as y,r as l,t as D,x as T,E as v,f as c,v as _,T as B,m as O,l as P,j as V}from"./entry.c55b7e60.js";import{P as K,i as z}from"./PopupMixin.78f0dbf7.js";import{i as s}from"./isKey.73a771a0.js";import{P as A}from"./PopupControlsMixin.267f22d0.js";const u="IDropdown",E=k({name:u,directives:{ClickOutside:b},mixins:[K,A],provide(){return{dropdown:this}},inject:{navbar:{default:()=>({onItemClick:()=>{}})},sidebar:{default:()=>({onItemClick:()=>{}})}},inheritAttrs:!1,props:{animationDuration:{type:Number,default:300},color:{type:String,default:p(u,"color")},disabled:{type:Boolean,default:!1},hideOnItemClick:{type:Boolean,default:!0},keydownTrigger:{type:Array,default:()=>["up","down","enter","space","tab","esc"]},keydownItem:{type:Array,default:()=>["up","down","enter","space","tab","esc"]},modelValue:{type:Boolean,default:!1},arrow:{type:Boolean,default:!0},placement:{type:String,default:"bottom"},trigger:{type:[String,Array],default:()=>["click"]},offset:{type:Number,default:6},interactable:{type:Boolean,default:!0},popperOptions:{type:Object,default:()=>({})},size:{type:String,default:p(u,"size"),validator:I}},emits:["click-outside","update:modelValue"],computed:{classes(){return{...C(this),[`-${this.size}`]:Boolean(this.size)}}},mounted(){for(const e of this.$refs.trigger.children)h(e,"keydown",this.onTriggerKeyDown);h(this.$refs.popup,"keydown",this.onItemKeyDown)},beforeUnmount(){for(const e of this.$refs.trigger.children)f(e,"keydown",this.onTriggerKeyDown);f(this.$refs.popup,"keydown",this.onItemKeyDown)},methods:{onEscape(){this.visible=!1,this.$emit("update:modelValue",!1)},handleClickOutside(e){this.visible=!1,this.$emit("update:modelValue",!1),this.onClickOutside(e)},getFocusableItems(){const e=[];for(const t of this.$refs.body.children)z(t)&&e.push(t);return e},onTriggerKeyDown(e){if(this.keydownTrigger.length===0)return;const t=this.getFocusableItems(),o=t.findIndex(d=>d.active),r=o>-1?o:0,i=t[r];switch(!0){case(s("up",e)&&this.keydownTrigger.includes("up")):case(s("down",e)&&this.keydownTrigger.includes("down")):this.show(),setTimeout(()=>{i.focus()},this.visible?0:this.animationDuration),e.preventDefault(),e.stopPropagation();break;case(s("enter",e)&&this.keydownTrigger.includes("enter")):case(s("space",e)&&this.keydownTrigger.includes("space")):this.onClick(),this.visible||setTimeout(()=>{i.focus()},this.animationDuration),e.preventDefault();break;case(s("tab",e)&&this.keydownTrigger.includes("tab")):case(s("esc",e)&&this.keydownTrigger.includes("esc")):this.hide();break}},onItemKeyDown(e){if(this.keydownItem.length!==0)switch(!0){case(s("up",e)&&this.keydownItem.includes("up")):case(s("down",e)&&this.keydownItem.includes("down")):const t=this.getFocusableItems(),o=t.findIndex(d=>d===e.target),r=t.length-1;let i;s("up",e)?i=o>0?o-1:0:i=o<r?o+1:r,t[i].focus(),e.preventDefault(),e.stopPropagation();break;case(s("enter",e)&&this.keydownItem.includes("enter")):case(s("space",e)&&this.keydownItem.includes("space")):e.target.click(),this.hideOnItemClick&&this.hide(),this.focusTrigger(),e.preventDefault();break;case(s("tab",e)&&this.keydownItem.includes("tab")):case(s("esc",e)&&this.keydownItem.includes("esc")):this.hide(),this.focusTrigger(),e.preventDefault();break}},onItemClick(){this.hideOnItemClick&&this.hide(),[this.navbar,this.sidebar].forEach(e=>{e.onItemClick()})}}}),N={class:"dropdown-trigger",ref:"trigger"},S=["aria-hidden"],F={key:0,"data-popper-arrow":""},j={key:1,class:"dropdown-header"},x={key:2,class:"dropdown-body",ref:"body"},L={key:3,class:"dropdown-footer"};function M(e,t,o,r,i,d){const g=$("click-outside");return m((a(),n("div",O({class:"dropdown-wrapper",ref:"wrapper","aria-haspopup":"true",onKeyup:t[0]||(t[0]=P((...w)=>e.onEscape&&e.onEscape(...w),["esc"]))},e.$attrs),[y("div",N,[l(e.$slots,"default")],512),D(B,{name:"zoom-in-top-transition",onAfterLeave:e.destroyPopper},{default:T(()=>[m(y("div",{class:v(["dropdown",e.classes]),role:"menu",ref:"popup","aria-hidden":e.visible?"false":"true"},[e.arrow?(a(),n("span",F)):c("",!0),e.$slots.header?(a(),n("div",j,[l(e.$slots,"header")])):c("",!0),e.$slots.body?(a(),n("div",x,[l(e.$slots,"body")],512)):c("",!0),e.$slots.footer?(a(),n("div",L,[l(e.$slots,"footer")])):c("",!0)],10,S),[[_,e.visible]])]),_:3},8,["onAfterLeave"])],16)),[[g,e.onClickOutside]])}const J=V(E,[["render",M]]);export{J as default};
